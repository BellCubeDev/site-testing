@import 'button-colors';

.fomod-editor-type {
    &:not(.active_) { display: none; }

    opacity: 0; &.active { opacity: 1; }
    transition-duration: 200ms;
    transition-timing-function: ease-in-out;
    transition-property: opacity;
}

.bcd-builder-input {
    background-color: #222;
    border-radius: 4px;
    border: #444 solid 2px;
    border-style: ridge;
    border-left: #4448 solid 4px;
    padding: 8px;
    padding-left: 8px;

    &--warn {
        border-left-color: #ff0;
    }

    &--error {
        border-left-color: #f00;
    }
}

.builder-steps-option-body .bcd-builder-input {
    margin-right: 0;
}

// Time to make an appearance!
@keyframes builder-steps-remove-btn-fadeIn {
    0% { filter: opacity(0); }
    5% { filter: opacity(0.1); }
    100% { filter: opacity(1); }
}

.builder-steps-remove-btn {
    position: absolute;
    right: 8px;

    animation-name: builder-steps-remove-btn-fadeIn;
    animation-duration: 210ms;
    animation-timing-function: ease-in-out;

    @media (prefers-reduced-motion: reduce) { animation-name: none; }
}

.builder-steps-drag-handle {
    opacity: .5;

    user-select: none;
    cursor: grab;

    position: absolute;
    top: 16px;
    left: 8px;
}

.no-sorting > * > .builder-steps-drag-handle {
    opacity: 0;
    pointer-events: none;
}

@keyframes sendInBigArtillery {
    0% {
        filter: opacity(0.67);
        transform: scale(0.99);
        margin-top: -90px;
    }

    100% {
        filter: opacity(1);
        transform: scale(1);
        margin-top: 0;
    }
}
@keyframes retractBigArtillery {
    0% {
        filter: opacity(1);
        transform: scale(1);
        margin-bottom: 0;
    }

    100% {
        filter: opacity(0.67);
        transform: scale(0.99);
        margin-bottom: -90px;
    }
}

@keyframes sendInArtillery {
    0% {
        filter: opacity(0.67);
        transform: scale(0.99);
        margin-top: -84px;
    }

    100% {
        filter: opacity(1);
        transform: scale(1);
        margin-top: 0;
    }
}
@keyframes retractArtillery {
    0% {
        filter: opacity(1);
        transform: scale(1);
        margin-bottom: 0;
    }

    100% {
        filter: opacity(0.67);
        transform: scale(0.99);
        margin-bottom: -84px;
    }
}

@mixin fomodStepsBuilderCard($hue, $sat, $val, $hueShiftMult: 1) {
    background: hsl($hue, $sat, $val);

    border: 0 solid black;
    border-left: hsl($hue + ($hueShiftMult * 48deg), $sat + 13%, $val + 17%) 8px solid;

    border-radius: 8px;
    padding: 12px;
    margin: 32px 0;
    padding-right: 48px;
    padding-left: 32px;

    position: relative;

    transform: scale(1);
    filter: opacity(1);

    > .js-bcd-summary {
        padding: 4px;
    }

    .animating-in {
        animation: sendInArtillery 200ms ease-out;
        @media (prefers-reduced-motion: reduce) { animation: none; }
    }

    .animating-out {
        animation: retractArtillery 200ms ease-in-out;
        margin-bottom: -84px;

        // Make the last element go up instead of down
        &:last-child {
            animation-name: sendInArtillery;
            animation-direction: reverse;
            margin-top: -84px;
            margin-bottom: 32px;
        }

        @media (prefers-reduced-motion: reduce) { animation: none !important; visibility: hidden; }
    }

    transition-property: filter, opacity;
    transition-duration: 500ms;

    .sortable-ghost {
        filter: contrast(0.5) grayscale(1) opacity(0.5);
        border: black 8px dashed;
        padding-top: 4px;
        padding-bottom: 4px;

        .builder-steps-remove-btn {
            right: 0;
        }
    }
}

@mixin imageColumn() {
    display: grid;
    justify-content: space-between;
    gap: 32px;
    align-items: start;
    grid-template-columns: minmax(0, 1fr) minmax(0, 40vw);
}

#steps-builder-container {
    @include fomodStepsBuilderCard(184deg, 87%, 25%);
    animation: none;
    padding-right: 16px;
    padding-left: 16px;

    >:first-child {
        @include imageColumn();

        >.builder-steps-mod-image {
            max-height: 50vmin;

            padding: 10px 8px;
            border-radius: 4px;

            background: #1c1c1c;
        }
    }
}

.builder-steps-step {
    @include fomodStepsBuilderCard(215deg, 76%, 23%);
    .animating-in { animation-name: sendInArtillery; }

    .animating-out {
        animation-name: retractBigArtillery;
        margin-bottom: -90px;

        // Make the last element go up instead of down
        &:last-child {
            animation-name: sendInBigArtillery;
            margin-top: -90px;
        }
    }

    > .builder-steps-drag-handle {
        top: 19px;
    }

    > .builder-steps-remove-btn {
        margin-top: 2px;
    }
}

.builder-steps-group {
    @include fomodStepsBuilderCard(37deg, 69%, 16%);
}

.builder-steps-option {
    @include fomodStepsBuilderCard(160deg, 0%, 9%);

    .js-bcd-details-inner > * { @include imageColumn(); }
}

.builder-steps-option-image, .builder-steps-mod-image {
    height: 100%;

    display: grid;
    grid-template-columns: 1fr auto 1fr;
    grid-template-rows: auto max-content;
    align-items: start;

    justify-content: center;
    justify-items: stretch;

    > img {
        max-height: calc(50vmin - 42px);
        max-width: 100%;
        grid-column: 2;
    }
}

.builder-steps-body-left {
    display: flex;
    flex-direction: column;
    flex-wrap: wrap;
    align-items: stretch;
    width: auto;
    grid-row: 1;
    gap: 24px;

    &--enforce-width {
        max-width: 40vw;
    }
}

.item-with-fake-label {
    display: flex;
    flex-direction: column;
    flex-wrap: nowrap;
    gap: 8px;

    &--one-liner {
        flex-direction: row;
        align-items: center;
        justify-content: flex-start;
        flex-wrap: wrap;
    }

    width: 100%;

    > :is(h1,h2,h3,h4,h5,h6) {
        margin: 0;
    }
}

// Disabled down here for clarity purposes
// scss-lint:disable MergeableSelector

#steps-builder-container sub {
    margin-left: 16px;
}

.builder-steps-condition-edit-btn {
    width: min(256px, 100%);
}

.mdl-button--raised.mdl-button--colored {
    &.builder-steps-add-child-btn {
        @include customColoredButton(286deg, 56%, 48%, 1, 0.2, 0.5, true);
        width: 160px;
        border-radius: 32px;
    }

    &.builder-steps-condition-edit-btn {
        @include customColoredButton(105deg, 74%, 35%)
    }
}
