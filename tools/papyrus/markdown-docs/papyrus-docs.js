import{trimWhitespace as os,capitalizeFirstLetter as cs,registerForEvents as v}from"../../../universal.js";import ds from"../../../assets/site/highlight_js/highlight.js";import ps from"../../../assets/site/highlight_js/languages/markdown.js";let us,ms,gs,ys,fs,ws;ds.registerLanguage("markdown",ps);export function ___bcdLoad_autoPapyDocsInit(){const e=[document.getElementById("papy_docs_lib-Name"),document.getElementById("papy_docs_lib-Link"),document.getElementById("papy_docs_register-pattern"),document.getElementById("papy_docs_md-output"),document.getElementById("papy_docs_file-picker"),document.getElementById("papy_docs_folder-picker")];if(e.some(e=>null===e))throw console.log(e),new TypeError("Looks like we're Missing elements!");us=e[0],ms=e[1],gs=e[2],ys=e[3],fs=e[4],v(fs,{activate:_s}),ws=e[5],v(ws,{activate:As})}window.bcd_init_functions.papyDocs=___bcdLoad_autoPapyDocsInit;const vs=/^Scriptname ([\w\d]+)(?:\s+extends ([\w\d]+))?(?:\s+(hidden))?(\s+(?:conditional))?(?:\s+(native))?(?:[\n\s]+\{([^}]+)\})?/is,hs=/\n*((?:^\s*;.*\n)+)(?:\s|;\/(?:\s|\S)*?\/;|\\)*Event(?:\s|;\/(?:\s|\S)*?\/;|\\)+([\w\d]+)(?:\s|;\/(?:\s|\S)*?\/;|\\)*\((?:\s|;\/(?:\s|\S)*?\/;|\\)*((?:[\w\d]+(?:\s|;\/(?:\s|\S)*?\/;|\\)+[\w\d]+(?:(?:\s|;\/(?:\s|\S)*?\/;|\\)*=(?:\s|;\/(?:\s|\S)*?\/;|\\)*(?:[\w\d]+|".*?(?<!\\)"))?(?:(?:\s|;\/(?:\s|\S)*?\/;|\\))*,(?:\s|;\/(?:\s|\S)*?\/;|\\)+)*[\w\d]+(?:(?:\s|;\/(?:\s|\S)*?\/;|\\)+[\w\d]+(?:\s|;\/(?:\s|\S)*?\/;|\\)*(?:=(?:\s|;\/(?:\s|\S)*?\/;|\\)*(?:[\w\d]+|".*?(?<!\\)"))?))?(?:\s|;\/(?:\s|\S)*?\/;|\\)*\)([\s\S]+?)^(?:\s|;\/(?:\s|\S)*?\/;|\\)*EndEvent/gim,Ss=/(?:\s|;\/.*?\/;|\\)*([\w\d]+)(\[])?(?:\s|;\/.*?\/;|\\)+([\w\d]+)(?:\s|;\/.*?\/;|\\)*(?:=(?:\s|;\/.*?\/;|\\)*(".+(?<!\\)"|[\w\d]+))?/gis,bs=/\n*((?:^\s*;.*\n)+)?(?:([\w\d]+)(\[.*?\])?(?:\s|;\/(?:\s|\S)*?\/;|\\)+)?Function(?:\s|;\/(?:\s|\S)*?\/;|\\)+([\w\d]+)(?:\s|;\/(?:\s|\S)*?\/;|\\)*\((?:\s|;\/(?:\s|\S)*?\/;|\\)*((?:[\w\d]+(?:\s|;\/(?:\s|\S)*?\/;|\\)+[\w\d]+(?:(?:\s|;\/(?:\s|\S)*?\/;|\\)*=(?:\s|;\/(?:\s|\S)*?\/;|\\)*(?:[\w\d]+(?:\.\d+)?|".*?(?<!\\)"))?(?:(?:\s|;\/(?:\s|\S)*?\/;|\\))*,(?:\s|;\/(?:\s|\S)*?\/;|\\)+)*[\w\d]+(?:(?:\s|;\/(?:\s|\S)*?\/;|\\)+[\w\d]+(?:\s|;\/(?:\s|\S)*?\/;|\\)*(?:=(?:\s|;\/(?:\s|\S)*?\/;|\\)*(?:[\w\d]+(?:\.\d+)?|".*?(?<!\\)"))?))?(?:\s|;\/(?:\s|\S)*?\/;|\\)*\)(?:\s|;\/(?:\s|\S)*?\/;|\\)+(?:(global)(?:\s|;\/(?:\s|\S)*?\/;|\\)+)?(?:(native)(?:(?:\s|;\/(?:\s|\S)*?\/;|\\)+(global))?(?:(?:\s|;\/(?:\s|\S)*?\/;|\\)+\{(.*?)\})?|(?:(?:(?:\s|;\/(?:\s|\S)*?\/;|\\)+\{(.*?)\})?([\s\S]+?)^(?:\s|;\/(?:\s|\S)*?\/;|\\)*EndFunction))/gim,$s=new RegExp(`[\\${["*","_","-","<",">","`","~","#","^","[","]","(",")","|",":"].join("\\")}]`,"g");function Es(e){return e.replace($s,"\\$&")}function ks(e){ys.innerHTML=ds.highlight(e,{language:"md"}).value}async function _s(){let e;try{e=(await window.showOpenFilePicker())[0]}catch(n){if(n instanceof Error&&"AbortError"===n.name)return;throw n}Ls(e,"read")&&ks(Ps(await Ns(await e.getFile())))}async function As(){let e;try{e=await window.showDirectoryPicker(),await async function(e){for(;!(await Ls(e,"readwrite"));)if(!window.confirm("You must give write permissions for this directory to use this application.\n\nClick OK to give permissions."))throw new DOMException("User denied directory write access","AbortError")}(e)}catch(n){if("AbortError"===n.name)return;throw n}await xs(e,async function(e,n,t){if("file"===n.kind&&e.endsWith(".psc")){const s=Ps(await Ns(await n.getFile()));!async function(e,n){const t=await e.createWritable();await t.write(n),t.close()}(await t.getFileHandle(`${e}.md`,{create:!0}),s),ks(s)}},-1)}async function xs(e,n,t=0){const s=[];for await(const[r,i]of e.entries())"file"===i.kind?s.push(n(r,i,e)):"directory"===i.kind&&0!=t&&s.push(xs(i,n,t-1));return await Promise.all(s)}async function Ls(e,n){return"granted"===await e.queryPermission({mode:n})||"granted"===await e.requestPermission({mode:n})}function Ns(e){return new Promise((n,t)=>{const s=new FileReader;s.onload=e=>{e.target&&"string"==typeof e.target.result&&n(e.target.result.replace(/\r\n?/g,"\n"))},s.onerror=e=>{t(e)},s.readAsText(e)})}function Ps(e){const n=function(e){const n=e.match(vs);return n?{name:n[1]??"",documentation:void 0===n[6]?"":n[6],parent:void 0===n[2]?"[Top-Level](/skyrim/developers/papyrus/top-level-index)":n[2],hidden:void 0!==n[3],conditional:void 0!==n[4],native:void 0!==n[5]}:{name:"",parent:"",documentation:"",conditional:!1,hidden:!1,native:!1}}(e),t=Ds(function(e){const n=[],t=e.matchAll(bs);for(const s of t)n.push({returns:{script:void 0===s[2]?"":cs(s[2]),isArray:void 0!==s[3]},name:s[4]??"",description:(void 0===s[1]?"":os(s[1]).replace(/^\s*;\s*/gm,""))+(void 0===s[1]||void 0===s[8]?"":"\n\n")+(void 0===s[8]?"":os(s[8]).replace(/^\s*;\s*/gm,""))+(void 0===s[8]||void 0===s[9]?"":"\n\n")+(void 0===s[9]?"":os(s[9]).replace(/^\s*;\s*/gm,"")),parameters:Ts(s[5]??""),global:void 0!==s[6]||void 0!==s[8],native:void 0!==s[7],body:"string"===s[11]?os(s[9]??""):""});return n}(e),"name");let s="";const r=Ds(function(e){const n=[],t=e.matchAll(hs);for(const s of t)n.push({name:s[2]??"",description:os(s[1]??"").replace(/^\s*;\s*/gm,""),parameters:Ts(s[3]??""),body:void 0===s[4]?"":os(s[4]),global:!1,native:!1,returns:{script:"None",isArray:!1}});return n}(e),"name");let i="";for(const o of r)i+=`| [${Es(o.name)}](${Fs(ms).replace(/\/?$/,"/")}${n.name}/${o.name}) | ${Es(o.description.replace(/\n/g,"<br />"))}${e.toLowerCase().includes(Fs(gs).replace(/%e%/gi,o.name.replace(/^on/i,"").replace(/(?:event)?(?:unregister(?:ed)?)?$/i,"").replace(/start|stop/i,"")).toLowerCase())?" | Registered | ":" | Unregistered | "}`+o.parameters.map(e=>`\`${Es(e.script)}\` *${Es(e.name)}*`).join(", <br />").replace(/, <br \/>$/,"")+" |\n";for(const o of t)s+=`| ${o.returns.script}${o.returns.isArray?"[]":""} | ${o.name} | ${o.description.replace(/\n/g,"<br />")} | `+o.parameters.map(e=>`\`${Es(e.script)}\` *${Es(e.name)}*`).join(", <br />").replace(/, <br \/>$/,"")+`| ${o.global?"Global":"Member"} | ${o.native?"Native":"Scripted"} |\n`;return os(`# ${n.name}\n\n| :-: | :-- |\n| Engine-Bound Type | \x3c!-- **USER-INPUTTED** --\x3e | \x3c!-- e.g. \`_NPC\` (Actor) --\x3e\n| [Parent](/skyrim/developers/papyrus/concepts/scripts#parents) | ${Es(n.parent)} |\n| [Library](/skyrim/developers/papyrus/concepts/libraries) | [${Es(Fs(us))}](${Es(Fs(ms))}) |\n\n${Es(n?.documentation?.replace(/^/gms,"> ").replace(/^> $/g,"")??"")}\n\n\x3c!-- **Add extra description HERE** --\x3e${s.length>0?"\n\n\n\n## [Native Functions](/skyrim/developers/papyrus/concepts/functions#native-flag)\n| Return Type | Function | Description | Parameters | [Global](/en/skyrim/developers/papyrus/concepts/functions#global_flag)? | [Native](/skyrim/developers/papyrus/concepts/functions#native-flag)?\n| --: | :-: | :-: | :-: | :-: | :-: |":""}\n${s}${i.length>0?"\n\n\n\n## [Events](https://modding.wiki/en/skyrim/developers/papyrus/concepts/events)\n| Event | Description | [Registration](https://modding.wiki/en/skyrim/developers/papyrus/concepts/functions#registration) | Parameters |\n| :-- | :-: | :-: | :-- |":""}\n${i}\n\n\n\n# Returning [Native Functions](https://modding.wiki/en/skyrim/developers/papyrus/concepts/functions#native-flag)\n\n[Native Functions](https://modding.wiki/en/skyrim/developers/papyrus/concepts/functions#native-flag) from any script or library that return an instance of this script\n\n\x3c!-- **MUST BE CREATED MANUALLY** --\x3e\n| Function | Description | [Array](/skyrim/developers/papyrus/concepts/arrays) | Script  | Library |\n|    :-:   |     :-:     |                         :-:                         |   :-:   |   :-:   |\n\n\n\n# [Children](/skyrim/developers/papyrus/concepts/scripts#children)\n\nScripts extending this script\n\n\x3c!-- **MUST BE CREATED MANUALLY** --\x3e\n| Script Name | Has Engine-Bound Type? | \x3c!-- Scripts with engine-bound types should come first --\x3e\n|     :-:     |          :-:           |\n`,!0)}function Ts(e){if("string"!=typeof e)return[];const n=[],t=e.matchAll(Ss);for(const s of t)n.push({script:cs(s[1]??""),isArray:void 0!==s[2],name:s[3]??"",default:void 0===s[4]?"":s[3]??""});return n}function Fs(e,n=!0){if(void 0===e)return"";try{if(void 0!==e.value&&""!=e.value)return e.value;if(e.hasAttribute("placeholder")&&n)return e.getAttribute("placeholder")??""}finally{}return""}function Ds(e,n){return e.sort((e,t)=>{const s=JSON.stringify(e[n]).toUpperCase(),r=JSON.stringify(t[n]).toUpperCase();return s<r?-1:s>r?1:0})}
//# sourceMappingURL=https://raw.githubusercontent.com/BellCubeDev/site-testing/deployment/tools/papyrus/markdown-docs/papyrus-docs.js.map