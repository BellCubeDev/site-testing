{"version":3,"file":"fomod-builder-xml-translator.ts","names":["classes","translateWhole","module","info","setWindowValues","parser","window","domParser","moduleDoc","parseFromString","documentElement","tagName","Error","infoDoc","console","log","obj","Fomod","getOrCreateChildByTag","FOMODBuilder","trackedFomod","destroy","loadTestFOMOD","fomod"],"sourceRoot":"https://raw.githubusercontent.com/BellCubeDev/site-testing/deployment/","sources":["https://raw.githubusercontent.com/BellCubeDev/site-testing/deployment/tools/fomod/fomod-builder-xml-translator.ts"],"sourcesContent":["import * as classes from './fomod-builder-classifications.js';\n\nexport function translateWhole(module: string, info: string, setWindowValues = false) : classes.Fomod {\n    const parser = window.domParser;\n\n    const moduleDoc = parser.parseFromString(module || '<config/>', 'text/xml');\n    if (moduleDoc.documentElement.tagName !== 'config') throw new Error('ModuleConfig.xml is not valid!'); // TODO: Inform user of error and provide a way to fix it\n\n    const infoDoc = parser.parseFromString(info || '<fomod/>', 'text/xml');\n    if (infoDoc.documentElement.tagName !== 'fomod') throw new Error('Info.xml is not valid!'); // TODO: Inform user of error and provide a way to fix it\n\n    console.log(\"Documents fetched!\", {moduleDoc, infoDoc});\n\n    const obj = new classes.Fomod(moduleDoc.getOrCreateChildByTag(\"config\"), infoDoc.getOrCreateChildByTag(\"fomod\"));\n\n    if (setWindowValues) {\n        if (window.FOMODBuilder.trackedFomod?.obj) window.FOMODBuilder.trackedFomod.obj.destroy();\n        window.FOMODBuilder.trackedFomod = {\n            obj,\n            infoDoc,\n            moduleDoc\n        };\n    }\n\n    return obj;\n}\n\ndeclare global {\n    interface Window {\n        loadTestFOMOD: () => void;\n    }\n}\n\nconst testInfo = `\n<fomod xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceSchemaLocation=\"https://testing.bellcube.dev/assets/site/misc/Info.xsd\">\n    <Name>Some Name™</Name>\n    <Author>Best Author Ever!</Author>\n    <Id>51238068465248570</Id>\n    <Website>https://www.google.com/</Website>\n    <Version>1.0.0</Version>\n</fomod>\n`;\n\nconst testModule = `\n<config xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceSchemaLocation=\"http://qconsulting.ca/fo3/ModConfig5.0.xsd\">\n    <moduleName>Some Name™</moduleName>\n    <moduleImage path=\"fomod/WoodworkersWhim.png\"/>\n</config>\n`;\n\nwindow.loadTestFOMOD = () => {\n    console.log(\"Loading test FOMOD...\");\n    const fomod = translateWhole(testModule, testInfo, true);\n    console.log(\"FOMOD loaded!\", fomod);\n};\n"],"mappings":"UAAYA,OAAa,4CAEnB,SAAUC,eAAeC,EAAgBC,EAAcC,GAAkB,GAC3E,MAAMC,EAASC,OAAOC,UAEhBC,EAAYH,EAAOI,gBAAgBP,GAAU,YAAa,YAChE,GAA0C,WAAtCM,EAAUE,gBAAgBC,QAAsB,MAAM,IAAIC,MAAM,kCAEpE,MAAMC,EAAUR,EAAOI,gBAAgBN,GAAQ,WAAY,YAC3D,GAAwC,UAApCU,EAAQH,gBAAgBC,QAAqB,MAAM,IAAIC,MAAM,0BAEjEE,QAAQC,IAAI,qBAAsB,CAACP,YAAWK,YAE9C,MAAMG,EAAM,IAAIhB,GAAQiB,MAAMT,EAAUU,sBAAsB,UAAWL,EAAQK,sBAAsB,UAWvG,OATId,IACIE,OAAOa,aAAaC,cAAcJ,KAAKV,OAAOa,aAAaC,aAAaJ,IAAIK,UAChFf,OAAOa,aAAaC,aAAe,CAC/BJ,MACAH,UACAL,cAIDQ,CACX,CAyBAV,OAAOgB,cAAgB,KACnBR,QAAQC,IAAI,yBACZ,MAAMQ,EAAQtB,eATC,yPAVF,yVAmBsC,GACnDa,QAAQC,IAAI,gBAAiBQ,EAAM"}