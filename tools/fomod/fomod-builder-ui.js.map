{"version":3,"file":"fomod-builder-ui.ts","names":["import","DropdownToLang","LangToDropdown","bcdUniversal","fomod","bcdFS","xml","pluralize_","pluralize","vkBeautify_","vkBeautify","updatePluralDisplay","element","count","textContent","getAttribute","translateDropdown","str","BCDDropdownSortingOrder","BCDDropdown","static","constructor","super","previousElementSibling","options","Manual","Alphabetical","BCDDropdownGroupType","BCDDropdownOptionState","Optional","Recommended","Required","firstSetEditor","setStepEditorType","type","includes","thisElem","document","getElementById","otherSteps","parentElement","querySelectorAll","transitionPhaseTwo","forEach","e","classList","remove","removeEventListener","ariaHidden","setAttribute","add","removeAttribute","nestAnimationFrames","contains","window","lazyStylesLoaded","length","addEventListener","once","setTimeout","FOMODBuilder","storage","preferences","stepsBuilder","async","showOpenAnotherFolderDialog","dialog","upgrades","getExtends","BCDModalDialog","result","show","console","debug","tabList","openFolder","test","loadingFomod","state","directory","trackedFomod","loadTestFOMOD","postLoad","openFolder_entry","warn","getNoSupportModal","loaded","wait","picked","getUserPickedFolder","handle","name","queryPermission","mode","fomodDir","childDirsC","moduleStr_","childFilesC","then","file","readAsText","infoStr_","moduleStr","infoStr","Promise","all","translateWhole","setOutputElements","saving","Error","infoDoc","moduleDoc","infoString","obj","asInfoXML","outerHTML","settings","formatXML","xmlmin","log","moduleString","asModuleXML","formatXml","string","save","fomodFolder","fomodInfo_","fomodModule_","fomodInfo","fomodModule","writeInfoPromise","write","writeModulePromise","hasUnsavedChanges","cleanSave","domParser","parseFromString","saveTimeout","autoSave","autoSaveAfterChange","clearTimeout","afterDelay","autoCleanSave","event","preventDefault","returnValue","init","registerBCDComponents","fomodUndoManager","registerForEvents"],"sourceRoot":"https://raw.githubusercontent.com/BellCubeDev/site-testing/deployment/","sources":["https://raw.githubusercontent.com/BellCubeDev/site-testing/deployment/tools/fomod/fomod-builder-ui.ts"],"sourcesContent":["/* eslint-disable import/first */\nimport * as mdl from '../../assets/site/mdl/material.js';\nimport * as bcdUniversal from '../../universal.js';\n\nimport * as fomodClasses from './fomod-builder-classifications.js';\nimport * as fomod from './fomod-builder.js';\n\nimport './fomod-builder-bindings.js';\nimport './fomod-builder-steps-1st-party.js';\nimport './fomod-builder-steps-vortex.js';\nimport './fomod-builder-steps-mo2.js';\n\nimport * as bcdFS from '../../filesystem-interface.js';\nimport * as xml from './fomod-builder-xml-translator.js';\n\n\nimport pluralize_ from '../../included_node_modules/plural/index.js';\nconst pluralize = pluralize_ as (word: string, count: number) => string;\n\nimport vkBeautify_ from '../../included_node_modules/vkbeautify/index.js';\nimport type vkBeautify__ from '../../../node_modules/@types/vkbeautify/index';\n\nconst vkBeautify = vkBeautify_ as unknown as typeof vkBeautify__;\n\nexport function updatePluralDisplay(element: Element, count: number) {\n    // eslint-disable-next-line prefer-template\n    element.textContent = count + ' ' + pluralize(element.getAttribute('unitWord') ?? '', count);\n}\n\nexport enum DropdownToLang {\n    Explicit = \"Manual\",\n    Ascending = \"Alphabetical\",\n    Descending = \"Reverse Alphabetical\",\n\n    SelectAny = \"Allow Any Selections\",\n    SelectAll = \"Force-Select Everything\",\n    SelectExactlyOne = \"Require Exactly One Selection\",\n    SelectAtMostOne = \"Require One or No Selections\",\n    SelectAtLeastOne = \"Require At Least One Selection\",\n\n    NotUsable = \"Not Useable\",\n    CouldBeUsable = \"Could Be Useable\",\n}\n\nexport enum LangToDropdown {\n    Manual = \"Explicit\",\n    Alphabetical = \"Ascending\",\n    \"Reverse Alphabetical\" = \"Descending\",\n\n    \"Allow Any Selections\" = \"SelectAny\",\n    \"Force-Select Everything\" = \"SelectAll\",\n    \"Require Exactly One Selection\" = \"SelectExactlyOne\",\n    \"Require One or No Selections\" = \"SelectAtMostOne\",\n    \"Require At Least One Selection\" = \"SelectAtLeastOne\",\n\n    \"Not Useable\" = \"NotUsable\",\n    \"Could Be Useable\" = \"CouldBeUsable\",\n}\n\n\nexport function translateDropdown(str: string): string {\n    if (typeof str !== 'string') return str;\n    if (str in DropdownToLang) return DropdownToLang[str as keyof typeof DropdownToLang];\n    if (str in LangToDropdown) return LangToDropdown[str as keyof typeof LangToDropdown];\n    return str;\n}\n\n\nexport class BCDDropdownSortingOrder extends bcdUniversal.BCDDropdown {\n    static readonly asString = 'FOMOD Builder - Sorting Order Dropdown';\n    static readonly cssClass = 'bcd-dropdown-sorting-order';\n\n    constructor(element: Element) {\n        super(element, element.previousElementSibling!, true);\n    }\n\n    override options() {\n        return {\n            'Manual': null,\n            'Alphabetical': null,\n            'Reverse Alphabetical': null\n        };\n    }\n}\n\nexport class BCDDropdownGroupType extends bcdUniversal.BCDDropdown {\n    static readonly asString = 'FOMOD Builder - Group Type Dropdown';\n    static readonly cssClass = 'bcd-dropdown-group-type';\n\n    constructor(element: Element) {\n        super(element, element.previousElementSibling!, true);\n    }\n\n    override options() {\n        return {\n            \"Allow Any Selections\": null,\n            \"Force-Select Everything\": null,\n            \"Require Exactly One Selection\": null,\n            \"Require One or No Selections\": null,\n            \"Require At Least One Selection\": null,\n        };\n    }\n}\n\nexport class BCDDropdownOptionState extends bcdUniversal.BCDDropdown {\n    static readonly asString = 'FOMOD Builder - Option State Dropdown';\n    static readonly cssClass = 'bcd-dropdown-option-state';\n\n    constructor(element: Element) {\n        super(element, element.previousElementSibling!, true);\n    }\n\n    override options() {\n        return {\n            \"Optional\": null,\n            \"Recommended\": null,\n            \"Could Be Useable\": null,\n            \"Required\": null,\n            \"Not Useable\": null\n        };\n    }\n}\n\n\n\nexport interface WindowUI {\n    openFolder: typeof openFolder;\n    save: typeof save;\n    cleanSave: typeof cleanSave;\n    attemptRepair: () => unknown;\n    setStepEditorType: typeof setStepEditorType;\n}\n\n\nexport type BCDBuilderType = 'builder'|'vortex'|'mo2';\n\nlet firstSetEditor = true;\nexport function setStepEditorType(type: BCDBuilderType) {\n\n    const workingEditors = ['builder'];\n    if (!workingEditors.includes(type)) type = 'builder';\n\n\n    const thisElem = document.getElementById(`steps-${type}-container`)!;\n    const otherSteps = thisElem.parentElement!.querySelectorAll(`.fomod-editor-type:not(#steps-${type}-container)${firstSetEditor ? '' : '.active'}`)!;\n\n    if (!firstSetEditor && thisElem.classList.contains('.active')) return;\n\n    if (type !== 'builder') {\n        if (!window.lazyStylesLoaded) thisElem.classList.add('needs-lazy');\n        else thisElem.classList.remove('needs-lazy');\n    }\n\n    function transitionPhaseTwo() {\n        otherSteps.forEach(e => {\n            e.classList.remove('active_');\n            e.removeEventListener('transitionend', transitionPhaseTwo);\n            e.ariaHidden = 'true';\n            e.setAttribute('hidden', '');\n        });\n\n        thisElem.classList.add('active_');\n        thisElem.ariaHidden = 'false';\n        thisElem.removeAttribute('hidden');\n\n        bcdUniversal.nestAnimationFrames(2, ()=>{\n            thisElem.classList.add('active');\n        });\n    }\n\n    if (otherSteps.length === 0) transitionPhaseTwo();\n    else {\n        otherSteps.forEach(e => {\n            e.classList.remove('active');\n            e.addEventListener('transitionend', transitionPhaseTwo, {once: true});\n        });\n        setTimeout(transitionPhaseTwo, 200);\n    }\n\n    firstSetEditor = false;\n    window.FOMODBuilder.storage.preferences!.stepsBuilder = type;\n}\n\nexport async function showOpenAnotherFolderDialog() {\n    const dialog = document.getElementById('opening-other-project-modal')!.upgrades!.getExtends(bcdUniversal.BCDModalDialog)[0]!;\n    const result = await dialog.show();\n    if (result !== 'confirm') {\n        console.debug(`User cancelled opening another folder with response \"${result}\"`);\n        return false;\n    } else {\n        console.debug(`User confirmed opening another folder with response \"${result}\"`);\n        return true;\n    }\n}\n\nlet tabList: HTMLDivElement|null = null;\nexport async function openFolder(test = false) {\n    if (loadingFomod.state) return;\n\n\n    if ( (window.FOMODBuilder.directory || window.FOMODBuilder.trackedFomod) && !await showOpenAnotherFolderDialog())\n        return;\n\n    if (test) {\n        loadingFomod.state = true;\n\n        window.loadTestFOMOD();\n\n        postLoad();\n\n        return;\n    }\n\n    if ('showDirectoryPicker' in window) return await openFolder_entry();\n\n    postLoad(false);\n\n    console.warn('No directory picker available for your system!');\n    fomod.getNoSupportModal()?.show();\n}\n\nexport async function postLoad(loaded = true) {\n    await bcdUniversal.wait(100);\n    loadingFomod.state = false;\n\n    tabList ??= document.getElementById('tablist') as HTMLDivElement;\n\n    if (loaded) {\n        tabList.removeAttribute('disabled');\n        tabList.classList.remove('tabs-list-container--hidden');\n    } else {\n        tabList.setAttribute('disabled', '');\n        tabList.classList.add('tabs-list-container--hidden');\n    }\n}\n\nexport const loadingFomod = {state: false};\n\nexport async function openFolder_entry() {\n    if (loadingFomod.state) return;\n    loadingFomod.state = true;\n\n    console.debug('Opening a folder!');\n\n    const picked = await bcdFS.getUserPickedFolder(true);\n    if (!picked) return loadingFomod.state = false;\n\n    console.debug('Picked folder:', picked);\n    console.debug('Picked folder name:', picked?.handle.name);\n    console.debug('Picked folder perms?', await picked?.handle.queryPermission({mode: 'readwrite'}));\n\n    window.FOMODBuilder.directory = picked;\n\n    const fomodDir = await picked.childDirsC['fomod']!;\n    const moduleStr_ = fomodDir.childFilesC['ModuleConfig.xml']!.then(file => file.readAsText());\n    const infoStr_ = fomodDir.childFilesC['Info.xml']!.then(file => file.readAsText());\n\n    const [moduleStr, infoStr] = await Promise.all([moduleStr_, infoStr_]);\n\n    xml.translateWhole(moduleStr, infoStr, true);\n\n    postLoad();\n}\n\n/** An alternative to `save` that will set the DOM elements instead. */\nexport async function setOutputElements() {\n    if (saving) return;\n    saving = true;\n\n    if (!window.FOMODBuilder.trackedFomod) throw new Error('No FOMOD is currently loaded.');\n\n    const infoDoc = window.FOMODBuilder.trackedFomod!.infoDoc;\n    const moduleDoc = window.FOMODBuilder.trackedFomod!.moduleDoc;\n\n    let infoString = window.FOMODBuilder.trackedFomod!.obj.asInfoXML(infoDoc).outerHTML || '<!-- ERROR - Serialized document was empty! -->';\n    if (window.FOMODBuilder.storage.settings.formatXML) infoString = vkBeautify.xml(infoString);\n    else infoString = vkBeautify.xmlmin(infoString, true);\n\n    console.log({infoString});\n    document.getElementById('info-xml')!.textContent = infoString;\n\n    let moduleString = window.FOMODBuilder.trackedFomod!.obj.asModuleXML(moduleDoc).outerHTML || '<!-- ERROR - Serialized document was empty! -->';\n    if (window.FOMODBuilder.storage.settings.formatXML) moduleString = vkBeautify.xml(moduleString);\n    else moduleString = vkBeautify.xmlmin(moduleString, true);\n\n    console.log({moduleString});\n    document.getElementById('module-xml')!.textContent = moduleString;\n\n    // Once we're done saving, note it as such.\n    saving = false;\n}\n\nfunction formatXml(string: string) {\n    if (window.FOMODBuilder.storage.settings.formatXML) return vkBeautify.xml(string);\n    else return vkBeautify.xmlmin(string, true);\n}\n\nlet saving = false;\nexport async function save() {\n    if (saving) return;\n    saving = true;\n\n    if (!window.FOMODBuilder.trackedFomod) throw new Error('No FOMOD is currently loaded.');\n\n    if (!window.FOMODBuilder.directory) {\n        await setOutputElements();\n        return saving = false;\n    }\n\n    const fomodFolder = (await window.FOMODBuilder.directory.childDirsC['fomod'])!;\n\n    const fomodInfo_ = fomodFolder.childFilesC['Info.xml']!;\n    const fomodModule_ = fomodFolder.childFilesC['ModuleConfig.xml']!;\n    const [fomodInfo, fomodModule] = await Promise.all([fomodInfo_, fomodModule_]);\n\n\n    const infoDoc = window.FOMODBuilder.trackedFomod!.infoDoc;\n    const infoString = formatXml(window.FOMODBuilder.trackedFomod!.obj.asInfoXML(infoDoc).outerHTML || '<!-- ERROR - Serialized document was empty! -->');\n    const writeInfoPromise = fomodInfo.write(infoString);\n    console.log({infoString});\n\n    const moduleDoc = window.FOMODBuilder.trackedFomod!.moduleDoc;\n    const moduleString = formatXml(window.FOMODBuilder.trackedFomod!.obj.asModuleXML(moduleDoc).outerHTML || '<!-- ERROR - Serialized document was empty! -->');\n    const writeModulePromise = fomodModule.write(moduleString);\n    console.log({moduleString});\n\n\n\n    // Once we're done saving, note it as such.\n    await Promise.all([writeInfoPromise, writeModulePromise]);\n    hasUnsavedChanges = false;\n    saving = false;\n}\n\nexport async function cleanSave(){\n    if (saving) return;\n    if (!window.FOMODBuilder.trackedFomod) throw new Error('No FOMOD is currently loaded.');\n\n    window.FOMODBuilder.trackedFomod!.infoDoc = window.domParser.parseFromString('<fomod/>', 'text/xml');\n    window.FOMODBuilder.trackedFomod!.moduleDoc = window.domParser.parseFromString('<config/>', 'text/xml');\n\n    return await save();\n}\n\nlet saveTimeout:null|number = null;\nlet hasUnsavedChanges = false;\nexport function autoSave() {\n    if (saving || loadingFomod.state) return;\n    if (!window.FOMODBuilder.trackedFomod) return;\n\n    hasUnsavedChanges = true;\n\n    if (!window.FOMODBuilder.storage.settings.autoSaveAfterChange) return;\n\n    if (saveTimeout !== null) clearTimeout(saveTimeout);\n    saveTimeout = bcdUniversal.afterDelay(500, () => {\n        saveTimeout = null;\n        if (window.FOMODBuilder.storage.settings.autoCleanSave) cleanSave();\n        else save();\n    });\n}\n\nwindow.addEventListener('beforeunload', (event) => {\n    if (!hasUnsavedChanges) return;\n\n    event.preventDefault();\n    event.returnValue = '';\n    return '';\n});\n\nexport function init() {\n    bcdUniversal.registerBCDComponents(BCDDropdownSortingOrder, BCDDropdownOptionState, BCDDropdownGroupType);\n    setStepEditorType(window.FOMODBuilder.storage.preferences.stepsBuilder);\n\n    // @ts-ignore\n    window.fomodUndoManager = fomodUndoManager;\n\n    window.registerForEvents(document, {\n        save: () => save(),\n    });\n\n    console.log('FOMOD Builder UI initialized.');\n}\n"],"mappings":"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"}