import hljs from '../../../assets/site/highlight_js/highlight.js';
import typescript from '../../../assets/site/highlight_js/languages/typescript.js';
hljs.registerLanguage('typescript', typescript);
window.bcd_init_functions.tsFromInline = function tsFromInline() {
    window.fromInline = {};
    window.fromInline.ui = {
        dataUpdated(evt) {
            console.debug('Data updated:', evt);
            if (!evt)
                throw new Error('There must be no hero, for there is no event.');
            const elem = evt.target;
            if (!elem)
                throw new Error('no target');
            try {
                parseData(elem.value.trim());
            }
            catch (err) {
                console.info('Parser failed with error', err);
                setOutput({});
            }
        }
    };
};
function parseData(str) {
    [, str] = str.match(/^\/\/# sourceMappingURL=(.*)/mi) ?? [undefined, str];
    console.debug('Parsing data:', str);
    try {
        const urlFrom = new URL(str);
        parseFromURL(urlFrom);
    }
    catch (err) {
        if (!(err instanceof TypeError))
            throw err;
        console.debug('Input is not a URL', str, '\n', err);
        parseFromJSON(str);
    }
}
async function parseFromURL(uri) {
    if (typeof uri === 'string')
        uri = new URL(uri);
    else if (!(uri instanceof URL))
        throw new Error('Input is not a valid URI');
    if (uri.protocol !== 'data:')
        throw new Error('Only `data:` URIs are supported');
    const [, ext, data] = uri.pathname.trim().match(/^(.+?);(?:[^,]*?;)*base64,(.*)$/) ?? [];
    if (ext !== 'application/json' || !data) {
        console.error(uri);
        throw new Error('Invalid Data URI or incorrect MIME type - see the above output for the URI');
    }
    const str = atob(data);
    parseFromJSON(str);
}
function parseFromJSON(obj) {
    if (typeof obj === 'string')
        obj = JSON.parse(obj);
    else if (typeof obj !== 'object')
        throw new Error('Input is not a JSON object');
    console.debug('Working with object:\n', obj);
    const sources = {};
    for (let i = 0; i < obj.sources.length; i++) {
        const file = obj.sources[i];
        const contents = obj.sourcesContent[i].trim().replace(/[^\n\S]+(?:\r\n?|\n)/g, '\n') + '\n';
        console.debug('Source', i, { [`${file}`]: contents });
        sources[file] = contents;
    }
    setOutput(sources);
}
async function setOutput(outs_) {
    const prefabOutput = document.getElementById('prefab-output');
    const outputArea = document.getElementById('output-area');
    const outs = Object.entries(outs_);
    outputArea.style.opacity = '0';
    await new Promise(resolve => {
        outputArea.addEventListener('transitionend', resolve, { once: true });
        setTimeout(() => {
            outputArea.removeEventListener('transitionend', resolve);
            resolve('timeout');
        }, 200);
    });
    outputArea.innerHTML = '';
    outputArea.style.opacity = '1';
    for (let i = 0; i < outs.length; i++) {
        const [file, data] = outs[i];
        const output = prefabOutput.cloneNode(true);
        output.id = `output-${i}`;
        output.classList.remove('hidden');
        output.removeAttribute('aria-hidden');
        output.querySelector('h3').textContent = file.trim();
        const code = output.querySelector('pre > code');
        code.innerHTML = hljs.highlight(data.trim(), { language: 'typescript' }).value.replace(/^\s*/y, '');
        outputArea.appendChild(output);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHMtZnJvbS1pbmxpbmUtc3JjLmpzIiwic291cmNlUm9vdCI6Imh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9CZWxsQ3ViZURldi9zaXRlLXRlc3RpbmcvZGVwbG95bWVudC8iLCJzb3VyY2VzIjpbInRvb2xzL3R5cGVzY3JpcHQvZnJvbS1pbmxpbmUtc291cmNlL3RzLWZyb20taW5saW5lLXNyYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLElBQUksTUFBTSxnREFBZ0QsQ0FBQztBQUdsRSxPQUFPLFVBQVUsTUFBTSwyREFBMkQsQ0FBQztBQUVuRixJQUFJLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxFQUFFLFVBQVUsQ0FBQyxDQUFDO0FBVWhELE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxZQUFZLEdBQUcsU0FBUyxZQUFZO0lBQzFELE1BQU0sQ0FBQyxVQUFVLEdBQUcsRUFBUyxDQUFDO0lBQzlCLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRSxHQUFHO1FBQ25CLFdBQVcsQ0FBQyxHQUFTO1lBQ2pCLE9BQU8sQ0FBQyxLQUFLLENBQUMsZUFBZSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1lBQ3BDLElBQUksQ0FBQyxHQUFHO2dCQUFFLE1BQU0sSUFBSSxLQUFLLENBQUMsK0NBQStDLENBQUMsQ0FBQztZQUMzRSxNQUFNLElBQUksR0FBSSxHQUFHLENBQUMsTUFBd0MsQ0FBQztZQUMzRCxJQUFJLENBQUMsSUFBSTtnQkFBRSxNQUFNLElBQUksS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRXhDLElBQUk7Z0JBQ0EsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQzthQUNoQztZQUFDLE9BQU8sR0FBRyxFQUFFO2dCQUNWLE9BQU8sQ0FBQyxJQUFJLENBQUMsMEJBQTBCLEVBQUUsR0FBRyxDQUFDLENBQUM7Z0JBQzlDLFNBQVMsQ0FBQyxFQUFFLENBQUMsQ0FBQzthQUNqQjtRQUNMLENBQUM7S0FD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QVMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbEMsTUFBTSxDQUFDLGVBQWUsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUV0QyxNQUFNLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBRSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFFdEQsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUUsQ0FBQztRQUNqRCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxFQUFFLEVBQUMsUUFBUSxFQUFFLFlBQVksRUFBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFbEcsVUFBVSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztLQUNsQztBQUVMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaGxqcyBmcm9tICcuLi8uLi8uLi9hc3NldHMvc2l0ZS9oaWdobGlnaHRfanMvaGlnaGxpZ2h0LmpzJztcblxuLy8gSExKUyBMYW5ndWFnZSBEZWZpbml0aW9uXG5pbXBvcnQgdHlwZXNjcmlwdCBmcm9tICcuLi8uLi8uLi9hc3NldHMvc2l0ZS9oaWdobGlnaHRfanMvbGFuZ3VhZ2VzL3R5cGVzY3JpcHQuanMnO1xuaW1wb3J0IHsgcmVnaXN0ZXJGb3JFdmVudHMgfSBmcm9tICcuLi8uLi8uLi91bml2ZXJzYWwuanMnO1xuaGxqcy5yZWdpc3Rlckxhbmd1YWdlKCd0eXBlc2NyaXB0JywgdHlwZXNjcmlwdCk7XG5cbmRlY2xhcmUgZ2xvYmFsIHtpbnRlcmZhY2UgV2luZG93IHtcbiAgICBmcm9tSW5saW5lOiB7XG4gICAgICAgIHVpOiB7XG4gICAgICAgICAgICBkYXRhVXBkYXRlZDogKGV2dDpFdmVudCkgPT4gdm9pZFxuICAgICAgICB9XG4gICAgfVxufX1cblxud2luZG93LmJjZF9pbml0X2Z1bmN0aW9ucy50c0Zyb21JbmxpbmUgPSBmdW5jdGlvbiB0c0Zyb21JbmxpbmUoKXtcbiAgICB3aW5kb3cuZnJvbUlubGluZSA9IHt9IGFzIGFueTtcbiAgICB3aW5kb3cuZnJvbUlubGluZS51aSA9IHtcbiAgICAgICAgZGF0YVVwZGF0ZWQoZXZ0OkV2ZW50KSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdEYXRhIHVwZGF0ZWQ6JywgZXZ0KTtcbiAgICAgICAgICAgIGlmICghZXZ0KSB0aHJvdyBuZXcgRXJyb3IoJ1RoZXJlIG11c3QgYmUgbm8gaGVybywgZm9yIHRoZXJlIGlzIG5vIGV2ZW50LicpO1xuICAgICAgICAgICAgY29uc3QgZWxlbSA9IChldnQudGFyZ2V0IGFzIEhUTUxUZXh0QXJlYUVsZW1lbnR8dW5kZWZpbmVkKTtcbiAgICAgICAgICAgIGlmICghZWxlbSkgdGhyb3cgbmV3IEVycm9yKCdubyB0YXJnZXQnKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBwYXJzZURhdGEoZWxlbS52YWx1ZS50cmltKCkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKCdQYXJzZXIgZmFpbGVkIHdpdGggZXJyb3InLCBlcnIpO1xuICAgICAgICAgICAgICAgIHNldE91dHB1dCh7fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufTtcblxuXG5mdW5jdGlvbiBwYXJzZURhdGEoc3RyOiBzdHJpbmcpe1xuXG4gICAgLy8gRXh0cmFjdCBkYXRhIHVybCBmcm9tIHRoZSBmdWxsIGZpbGUgb3IsIGJhcnJpbmcgdGhhdCwgdXNlIHRoZSBpbnB1dCBhcy1pc1xuICAgIFssc3RyXSA9IHN0ci5tYXRjaCgvXlxcL1xcLyMgc291cmNlTWFwcGluZ1VSTD0oLiopL21pKSA/PyBbdW5kZWZpbmVkLCBzdHJdO1xuXG4gICAgY29uc29sZS5kZWJ1ZygnUGFyc2luZyBkYXRhOicsIHN0cik7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCB1cmxGcm9tID0gbmV3IFVSTChzdHIpO1xuICAgICAgICBwYXJzZUZyb21VUkwodXJsRnJvbSk7XG4gICAgfVxuXG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBUeXBlRXJyb3IpKSB0aHJvdyBlcnI7XG4gICAgICAgIGNvbnNvbGUuZGVidWcoJ0lucHV0IGlzIG5vdCBhIFVSTCcsIHN0ciwgJ1xcbicsIGVycik7XG5cbiAgICAgICAgcGFyc2VGcm9tSlNPTihzdHIpO1xuICAgIH1cbn1cblxuLyoqIFBhcnNlcyBhbiBgYXBwbGljYXRpb24vanNvbmAgRGF0YSBVUkkgaW50byBpdHMgcmF3IEpTT04gY29tcG9uZW50IGFuZCBwYXNzZXMgaXQgb24gdG8gUGFyc2VKU09OICovXG5hc3luYyBmdW5jdGlvbiBwYXJzZUZyb21VUkwodXJpOiBVUkwpe1xuICAgIGlmICh0eXBlb2YgdXJpID09PSAnc3RyaW5nJykgdXJpID0gbmV3IFVSTCh1cmkpO1xuICAgIGVsc2UgaWYgKCEodXJpIGluc3RhbmNlb2YgVVJMKSkgdGhyb3cgbmV3IEVycm9yKCdJbnB1dCBpcyBub3QgYSB2YWxpZCBVUkknKTtcblxuICAgIGlmICh1cmkucHJvdG9jb2wgIT09ICdkYXRhOicpIHRocm93IG5ldyBFcnJvcignT25seSBgZGF0YTpgIFVSSXMgYXJlIHN1cHBvcnRlZCcpO1xuXG4gICAgY29uc3QgWyxleHQsIGRhdGFdID0gdXJpLnBhdGhuYW1lLnRyaW0oKS5tYXRjaCgvXiguKz8pOyg/OlteLF0qPzspKmJhc2U2NCwoLiopJC8pID8/IFtdO1xuXG4gICAgaWYgKGV4dCAhPT0gJ2FwcGxpY2F0aW9uL2pzb24nIHx8ICFkYXRhKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IodXJpKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIERhdGEgVVJJIG9yIGluY29ycmVjdCBNSU1FIHR5cGUgLSBzZWUgdGhlIGFib3ZlIG91dHB1dCBmb3IgdGhlIFVSSScpO1xuICAgIH1cblxuICAgIGNvbnN0IHN0ciA9IGF0b2IoZGF0YSk7XG4gICAgLy9jb25zdCBzdHIgPSBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKHdpbmRvdy5hdG9iKGRhdGEpKSk7XG4gICAgLy9jb25zdCBzdHIgPSAoYXdhaXQgbmV3IEJsb2IoW2RhdGFdLCB7dHlwZTogJ2V4dCcsIGVuZGluZ3M6ICduYXRpdmUnfSkudGV4dCgpKS50b1N0cmluZygpO1xuXG4gICAgcGFyc2VGcm9tSlNPTihzdHIpO1xufVxuXG50eXBlIG91dHMgPSB7W2ZpbGU6c3RyaW5nXTogc3RyaW5nfVxuXG5mdW5jdGlvbiBwYXJzZUZyb21KU09OKG9iajogYW55KSB7XG4gICAgaWYgKHR5cGVvZiBvYmogPT09ICdzdHJpbmcnKSBvYmogPSBKU09OLnBhcnNlKG9iaik7XG4gICAgZWxzZSBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcpIHRocm93IG5ldyBFcnJvcignSW5wdXQgaXMgbm90IGEgSlNPTiBvYmplY3QnKTtcblxuICAgIGNvbnNvbGUuZGVidWcoJ1dvcmtpbmcgd2l0aCBvYmplY3Q6XFxuJywgb2JqKTtcblxuICAgIGNvbnN0IHNvdXJjZXM6b3V0cyA9IHt9O1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYmouc291cmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBmaWxlID0gb2JqLnNvdXJjZXNbaV07XG5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci10ZW1wbGF0ZVxuICAgICAgICBjb25zdCBjb250ZW50cyA9IChvYmouc291cmNlc0NvbnRlbnRbaV0gYXMgc3RyaW5nKS50cmltKCkucmVwbGFjZSgvW15cXG5cXFNdKyg/Olxcclxcbj98XFxuKS9nLCAnXFxuJykgKyAnXFxuJztcblxuICAgICAgICBjb25zb2xlLmRlYnVnKCdTb3VyY2UnLCBpLCB7W2Ake2ZpbGV9YF06IGNvbnRlbnRzfSk7XG4gICAgICAgIHNvdXJjZXNbZmlsZV0gPSBjb250ZW50cztcbiAgICB9XG5cbiAgICBzZXRPdXRwdXQoc291cmNlcyk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNldE91dHB1dChvdXRzXzogb3V0cykge1xuICAgIGNvbnN0IHByZWZhYk91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmVmYWItb3V0cHV0JykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgY29uc3Qgb3V0cHV0QXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdXRwdXQtYXJlYScpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgIGNvbnN0IG91dHMgPSBPYmplY3QuZW50cmllcyhvdXRzXyk7XG5cbiAgICAvLyBOT1RFOiBSRVFVSVJFUyBhbiBvcGFjaXR5IHRyYW5zaXRpb24gdW5kZXIgMjAwbXMhXG5cbiAgICBvdXRwdXRBcmVhLnN0eWxlLm9wYWNpdHkgPSAnMCc7XG5cbiAgICAvLyBXYWl0IGZvciB0aGUgdHJhbnNpdGlvbiB0byBmaW5pc2hcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgb3V0cHV0QXJlYS5hZGRFdmVudExpc3RlbmVyKCd0cmFuc2l0aW9uZW5kJywgcmVzb2x2ZSwge29uY2U6IHRydWV9KTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBvdXRwdXRBcmVhLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCByZXNvbHZlKTtcbiAgICAgICAgICAgIHJlc29sdmUoJ3RpbWVvdXQnKTtcbiAgICAgICAgfSwgMjAwKTtcbiAgICB9KTtcblxuICAgIG91dHB1dEFyZWEuaW5uZXJIVE1MID0gJyc7XG4gICAgb3V0cHV0QXJlYS5zdHlsZS5vcGFjaXR5ID0gJzEnOyAvLyBEb24ndCB3b3JyeSwgdGhpcyBpc24ndCBhIHJhY2UgY29uZGl0aW9uIC0gdGhhbmsgeW91LCBFdmVudCBMb29wIVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvdXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IFtmaWxlLCBkYXRhXSA9IG91dHNbaV0hO1xuXG4gICAgICAgIGNvbnN0IG91dHB1dCA9IHByZWZhYk91dHB1dC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgIG91dHB1dC5pZCA9IGBvdXRwdXQtJHtpfWA7XG4gICAgICAgIG91dHB1dC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgICAgb3V0cHV0LnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nKTtcblxuICAgICAgICBvdXRwdXQucXVlcnlTZWxlY3RvcignaDMnKSEudGV4dENvbnRlbnQgPSBmaWxlLnRyaW0oKTtcblxuICAgICAgICBjb25zdCBjb2RlID0gb3V0cHV0LnF1ZXJ5U2VsZWN0b3IoJ3ByZSA+IGNvZGUnKSE7XG4gICAgICAgIGNvZGUuaW5uZXJIVE1MID0gaGxqcy5oaWdobGlnaHQoZGF0YS50cmltKCksIHtsYW5ndWFnZTogJ3R5cGVzY3JpcHQnfSkudmFsdWUucmVwbGFjZSgvXlxccyoveSwgJycpO1xuXG4gICAgICAgIG91dHB1dEFyZWEuYXBwZW5kQ2hpbGQob3V0cHV0KTtcbiAgICB9XG5cbn1cbiJdfQ==